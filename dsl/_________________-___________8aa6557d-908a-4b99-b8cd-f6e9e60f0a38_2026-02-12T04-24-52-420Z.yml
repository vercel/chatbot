kind: app
version: 0.1.5

app:
  name: „Ç§„É≥„ÉÜ„É™„Ç∏„Çß„É≥„ÉàÁ†îÁ©∂„Ç¢„Ç∑„Çπ„Çø„É≥„Éà - Â§öÊÆµÈöéÂàÜÊûê„Ç∑„Çπ„ÉÜ„É†
  description: |
    Á†îÁ©∂„ÉÜ„Éº„Éû„Çí5„Å§„ÅÆ„Ç´„ÉÜ„Ç¥„É™ÔºàÊäÄË°ìÁ†îÁ©∂„ÄÅÂ∏ÇÂ†¥ÂàÜÊûê„ÄÅÂ≠¶Ë°ìÁ†îÁ©∂„ÄÅ„Éì„Ç∏„Éç„ÇπÊà¶Áï•„ÄÅ„Åù„ÅÆ‰ªñÔºâ„Å´ÂàÜÈ°û„Åó„ÄÅ
    „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫‚ÜíWebÊ§úÁ¥¢‚Üí„Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàê‚Üí„Çµ„Éñ„ÉÜ„Éº„ÉûÂà•„ÅÆË©≥Á¥∞ÂàÜÊûê‚ÜíÂìÅË≥™Ê§úË®ºÔºà‰∏çË∂≥ÊôÇ„ÅØÊúÄÂ§ß3ÂõûÂÜçÁîüÊàêÔºâ‚Üí„É¨„Éù„Éº„ÉàÊï¥ÂΩ¢„Åæ„Åß„ÇíÂÆüË°å„Åô„ÇãÂ§öÊÆµÈöéÂàÜÊûê„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÄÇ
  mode: workflow
  icon: üî¨
  icon_background: '#4A90E2'
  use_icon_as_answer_icon: false

dependencies: []

workflow:
  conversation_variables: []
  environment_variables:
    - description: 'Tavily Search API Key'
      id: tavily_api_key_env
      name: TAVILY_API_KEY
      value: ''
      value_type: secret

  features:
    file_upload:
      enabled: false
      allowed_file_types: []
      allowed_file_extensions: []
      allowed_file_upload_methods:
        - local_file
        - remote_url
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
          - local_file
          - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''

  graph:
    nodes:
      # ============================================================
      # Start
      # ============================================================
      - data:
          type: start
          title: ÈñãÂßã
          desc: Á†îÁ©∂„ÉÜ„Éº„Éû„ÇíÂèó„ÅëÂèñ„Çä„Åæ„Åô
          selected: false
          variables:
            - label: Á†îÁ©∂„ÉÜ„Éº„Éû
              variable: research_topic
              type: text-input
              required: true
              max_length: 1000
              options: []
        height: 88
        id: start_research
        position:
          x: -650
          y: 250
        positionAbsolute:
          x: -650
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 242

      # ============================================================
      # Question Classifier
      # ============================================================
      - data:
          type: question-classifier
          title: Á†îÁ©∂„ÉÜ„Éº„ÉûÂàÜÈ°û
          desc: Á†îÁ©∂„ÉÜ„Éº„Éû„Çí5„Å§„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Å´ÂàÜÈ°û„Åó„Åæ„Åô„ÄÇ
          instructions: |
            ÂÖ•Âäõ„Åï„Çå„ÅüÁ†îÁ©∂„ÉÜ„Éº„Éû„Çí‰ª•‰∏ã„ÅÆ5„Å§„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Å´ÂøÖ„ÅöÂàÜÈ°û„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

            - ÊäÄË°ìÁ†îÁ©∂: ÊäÄË°ìÁöÑ„Å™Á†îÁ©∂„ÄÅÈñãÁô∫„ÄÅÂÆüË£Ö„ÄÅ„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„ÉÅ„É£„ÄÅ„Ç¢„É´„Ç¥„É™„Ç∫„É†Ôºà‰æã: AIÊäÄË°ì„ÄÅ„Éñ„É≠„ÉÉ„ÇØ„ÉÅ„Çß„Éº„É≥„ÄÅ„ÇØ„É©„Ç¶„Éâ„ÄÅMLOpsÔºâ
            - Â∏ÇÂ†¥ÂàÜÊûê: Â∏ÇÂ†¥Ë¶èÊ®°„ÄÅÁ´∂Âêà„ÄÅÈ°ßÂÆ¢„ÄÅ‰æ°Ê†º„ÄÅ„Éà„É¨„É≥„ÉâÔºà‰æã: Â∏ÇÂ†¥Ë™øÊüª„ÄÅÁ´∂ÂêàÊØîËºÉ„ÄÅÈúÄË¶Å‰∫àÊ∏¨Ôºâ
            - Â≠¶Ë°ìÁ†îÁ©∂: ÂÖàË°åÁ†îÁ©∂„ÄÅ‰ªÆË™¨„ÄÅÂÆüÈ®ìË®≠Ë®à„ÄÅË©ï‰æ°„ÄÅÁêÜË´ñÔºà‰æã: Ë´ñÊñáË™øÊüª„ÄÅÁ†îÁ©∂Ë®àÁîªÔºâ
            - „Éì„Ç∏„Éç„ÇπÊà¶Áï•: ‰∫ãÊ•≠Êà¶Áï•„ÄÅÂèéÁõä„É¢„Éá„É´„ÄÅGo-to-Market„ÄÅ„É™„Çπ„ÇØ„ÄÅ„É≠„Éº„Éâ„Éû„ÉÉ„ÉóÔºà‰æã: Êñ∞Ë¶è‰∫ãÊ•≠„ÄÅÊà¶Áï•Á´ãÊ°àÔºâ
            - „Åù„ÅÆ‰ªñ: ‰∏äË®ò„ÅÑ„Åö„Çå„Å´„ÇÇÊòéÁ¢∫„Å´ÂΩì„Å¶„ÅØ„Åæ„Çâ„Å™„ÅÑ„ÇÇ„ÅÆÔºàËø∑„ÅÜÂ†¥Âêà„ÇÇÂê´„ÇÄÔºâ

            Âá∫Âäõ„ÅØÊúÄ„ÇÇÈÅ©Âàá„Å™1„Ç´„ÉÜ„Ç¥„É™„ÅÆ„Åø„ÄÇ
          query_variable_selector:
            - start_research
            - research_topic
          classes:
            - id: tech_research
              name: ÊäÄË°ìÁ†îÁ©∂
            - id: market_analysis
              name: Â∏ÇÂ†¥ÂàÜÊûê
            - id: academic_research
              name: Â≠¶Ë°ìÁ†îÁ©∂
            - id: business_strategy
              name: „Éì„Ç∏„Éç„ÇπÊà¶Áï•
            - id: other
              name: „Åù„ÅÆ‰ªñ
          model:
            mode: chat
            name: gpt-4o
            provider: langgenius/openai/openai
            completion_params:
              temperature: 0.2
              max_tokens: 512
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          selected: false
          topics: []
        height: 380
        id: qc_research
        position:
          x: -330
          y: 250
        positionAbsolute:
          x: -330
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 260

      # ============================================================
      # Code: ÂâçÂá¶ÁêÜ
      # ============================================================
      - data:
          type: code
          title: „Éë„É©„É°„Éº„ÇøÊäΩÂá∫
          desc: Á†îÁ©∂„ÉÜ„Éº„Éû„ÇíÊï¥ÂΩ¢„Åó„ÄÅÂæåÁ∂öÂá¶ÁêÜÁî®„Éë„É©„É°„Éº„Çø„Çí‰ΩúÊàê„Åó„Åæ„Åô
          code_language: python3
          code: |
            def main(research_topic: str) -> dict:
                topic = (research_topic or "").strip()
                return {
                    "formatted_topic": topic,
                    "topic_length": len(topic),
                }
          outputs:
            formatted_topic:
              children: null
              type: string
            topic_length:
              children: null
              type: number
          variables:
            - value_selector:
                - start_research
                - research_topic
              variable: research_topic
          selected: false
        height: 200
        id: code_param_extract
        position:
          x: 20
          y: 250
        positionAbsolute:
          x: 20
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 300

      # ============================================================
      # LLM: „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫Ôºà„Ç´„ÉÜ„Ç¥„É™Âà•Ôºâ
      # ============================================================
      - data:
          type: llm
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫ÔºàÊäÄË°ìÁ†îÁ©∂Ôºâ
          desc: ÊäÄË°ìÁ†îÁ©∂Âêë„Åë„Å´„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.2
              max_tokens: 800
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÁ†îÁ©∂„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇÊäÄË°ìÁ†îÁ©∂„ÉÜ„Éº„Éû„Åã„ÇâÈáçË¶Å„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                5„Äú10ÂÄãÁ®ãÂ∫¶„ÄÇÈáçË§á„ÇíÈÅø„Åë„ÄÅÊ§úÁ¥¢„Å´‰Ωø„Åà„ÇãÂÖ∑‰ΩìË™û„ÇíÂÑ™ÂÖà„Åó„Åæ„Åô„ÄÇ
                ÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"keywords":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 220
        id: llm_keyword_tech
        position:
          x: 360
          y: 90
        positionAbsolute:
          x: 360
          y: 90
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      - data:
          type: llm
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫ÔºàÂ∏ÇÂ†¥ÂàÜÊûêÔºâ
          desc: Â∏ÇÂ†¥ÂàÜÊûêÂêë„Åë„Å´„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.2
              max_tokens: 800
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÂ∏ÇÂ†¥ÂàÜÊûê„ÅÆ„É™„Çµ„Éº„ÉÅ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇÂ∏ÇÂ†¥„ÉªÁ´∂Âêà„ÉªÈ°ßÂÆ¢„Éª‰æ°Ê†º„Éª„Éà„É¨„É≥„Éâ„Å´Èñ¢„Åô„ÇãÊ§úÁ¥¢„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                5„Äú10ÂÄãÁ®ãÂ∫¶„ÄÇÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"keywords":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 220
        id: llm_keyword_market
        position:
          x: 360
          y: 210
        positionAbsolute:
          x: 360
          y: 210
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      - data:
          type: llm
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫ÔºàÂ≠¶Ë°ìÁ†îÁ©∂Ôºâ
          desc: Â≠¶Ë°ìÁ†îÁ©∂Âêë„Åë„Å´„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.2
              max_tokens: 800
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÂ≠¶Ë°ìÁ†îÁ©∂„ÅÆ„É™„Çµ„Éº„ÉÅ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇÂÖàË°åÁ†îÁ©∂Êé¢Á¥¢„Å´ÈÅ©„Åó„Åü„Ç≠„Éº„ÉØ„Éº„ÉâÔºàËã±Ë™û„ÇÇÂèØÔºâ„ÇíÊäΩÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                5„Äú10ÂÄãÁ®ãÂ∫¶„ÄÇÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"keywords":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 220
        id: llm_keyword_academic
        position:
          x: 360
          y: 330
        positionAbsolute:
          x: 360
          y: 330
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      - data:
          type: llm
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫Ôºà„Éì„Ç∏„Éç„ÇπÊà¶Áï•Ôºâ
          desc: „Éì„Ç∏„Éç„ÇπÊà¶Áï•Âêë„Åë„Å´„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.2
              max_tokens: 800
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØ„Éì„Ç∏„Éç„ÇπÊà¶Áï•„ÅÆ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇÂèéÁõä„É¢„Éá„É´„ÄÅÊñΩÁ≠ñ„ÄÅ„É™„Çπ„ÇØ„ÄÅÁ´∂‰∫âÂÑ™‰Ωç„ÄÅ„É≠„Éº„Éâ„Éû„ÉÉ„Éó„Å´Èñ¢„Åô„ÇãÊ§úÁ¥¢„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                5„Äú10ÂÄãÁ®ãÂ∫¶„ÄÇÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"keywords":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 220
        id: llm_keyword_business
        position:
          x: 360
          y: 450
        positionAbsolute:
          x: 360
          y: 450
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      - data:
          type: llm
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫Ôºà„Åù„ÅÆ‰ªñÔºâ
          desc: Ê±éÁî®„ÅÆ„Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.2
              max_tokens: 800
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØ„É™„Çµ„Éº„ÉÅ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ„ÉÜ„Éº„Éû„Åã„ÇâÊ§úÁ¥¢Áî®„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÊäΩÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                5„Äú10ÂÄãÁ®ãÂ∫¶„ÄÇÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"keywords":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 220
        id: llm_keyword_other
        position:
          x: 360
          y: 570
        positionAbsolute:
          x: 360
          y: 570
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      # ============================================================
      # Code: „Ç≠„Éº„ÉØ„Éº„ÉâÈÖçÂàóÊï¥ÂΩ¢ÔºàÂêàÊµÅÔºâ
      # ============================================================
      - data:
          type: code
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÈÖçÂàóÊï¥ÂΩ¢
          desc: ÂàÜÂ≤êLLM„ÅÆÂá∫Âäõ„Åã„ÇâkeywordsÈÖçÂàó„ÇíÊäΩÂá∫„ÉªÊ≠£Ë¶èÂåñ„Åó„Åæ„Åô
          code_language: python3
          code: |
            import json
            import re

            def _extract_keywords(text: str) -> list:
                if not text:
                    return []
                # JSONÊäΩÂá∫
                m = re.search(r'\{.*"keywords"\s*:\s*\[.*?\].*\}', text, re.DOTALL)
                if m:
                    try:
                        obj = json.loads(m.group())
                        kws = obj.get("keywords", [])
                        if isinstance(kws, list):
                            return [str(k).strip() for k in kws if str(k).strip()]
                    except Exception:
                        pass
                # ÈÖçÂàó„Å£„ÅΩ„ÅÑ„ÇÇ„ÅÆ
                m2 = re.search(r'\[.*?\]', text, re.DOTALL)
                if m2:
                    try:
                        arr = json.loads(m2.group())
                        if isinstance(arr, list):
                            return [str(k).strip() for k in arr if str(k).strip()]
                    except Exception:
                        pass
                # „Ç´„É≥„ÉûÂå∫Âàá„Çä
                return [k.strip() for k in text.split(",") if k.strip()]

            def main(llm_text: str) -> dict:
                keywords = _extract_keywords(llm_text)
                keywords = keywords[:10]
                if not keywords:
                    keywords = ["Á†îÁ©∂", "ÂàÜÊûê"]
                return {"keywords": keywords}
          outputs:
            keywords:
              children: null
              type: array[string]
          variables:
            - value_selector:
                - llm_keyword_other
                - text
              variable: llm_text
          selected: false
        height: 280
        id: code_keyword_format
        position:
          x: 720
          y: 250
        positionAbsolute:
          x: 720
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      # ============================================================
      # Iteration: „Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢
      # ============================================================
      - data:
          type: iteration
          title: „Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢ÔºàÂèçÂæ©Ôºâ
          desc: ÂêÑ„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßWebÊ§úÁ¥¢„ÇíÂÆüË°å„Åó„Åæ„Åô
          iterator_selector:
            - code_keyword_format
            - keywords
          start_node_id: iter_keyword_searchstart
          output_selector:
            - code_keyword_search_format
            - search_result
          output_type: array[string]
          is_parallel: false
          parallel_nums: 3
          error_handle_mode: remove-abnormal-output
          selected: false
        height: 420
        id: iter_keyword_search
        position:
          x: 1100
          y: 150
        positionAbsolute:
          x: 1100
          y: 150
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 669
        zIndex: 1

      - data:
          type: iteration-start
          title: ''
          desc: ''
          isInIteration: true
          selected: false
        draggable: false
        height: 48
        id: iter_keyword_searchstart
        parentId: iter_keyword_search
        position:
          x: 24
          y: 68
        positionAbsolute:
          x: 1124
          y: 218
        selectable: false
        sourcePosition: right
        targetPosition: left
        type: custom-iteration-start
        width: 44
        zIndex: 1002

      - data:
          type: tool
          title: TavilyÊ§úÁ¥¢Ôºà„Ç≠„Éº„ÉØ„Éº„ÉâÔºâ
          desc: „Ç≠„Éº„ÉØ„Éº„Éâ„ÅßWebÊ§úÁ¥¢
          provider_type: builtin
          provider_id: tavily
          provider_name: tavily
          tool_name: tavily_search
          tool_label: TavilySearch
          tool_configurations:
            exclude_domains: null
            include_answer: 0
            include_domains: null
            include_images: 0
            include_raw_content: 0
            max_results: 5
            search_depth: basic
          tool_parameters:
            query:
              type: mixed
              value: '{{#iter_keyword_search.item#}}'
          isInIteration: true
          iteration_id: iter_keyword_search
          selected: false
        height: 246
        id: tool_tavily_keyword
        parentId: iter_keyword_search
        position:
          x: 128
          y: 68
        positionAbsolute:
          x: 1228
          y: 218
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 300
        zIndex: 1002

      - data:
          type: code
          title: Ê§úÁ¥¢ÁµêÊûúÊï¥ÂΩ¢Ôºà„Ç≠„Éº„ÉØ„Éº„ÉâÔºâ
          desc: Ê§úÁ¥¢ÁµêÊûú„ÇíÁü≠„ÅèÊï¥ÂΩ¢
          code_language: python3
          code: |
            def main(result_text) -> dict:
                text = ""
                if isinstance(result_text, str):
                    text = result_text
                elif result_text is None:
                    text = ""
                else:
                    text = str(result_text)

                text = text.strip()
                if not text:
                    return {"search_result": "Ê§úÁ¥¢ÁµêÊûú„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"}

                return {"search_result": text[:600]}
          outputs:
            search_result:
              children: null
              type: string
          variables:
            - value_selector:
                - tool_tavily_keyword
                - text
              variable: result_text
          isInIteration: true
          iteration_id: iter_keyword_search
          selected: false
        height: 210
        id: code_keyword_search_format
        parentId: iter_keyword_search
        position:
          x: 468
          y: 68
        positionAbsolute:
          x: 1568
          y: 218
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 300
        zIndex: 1002

      # ============================================================
      # Code: Ê§úÁ¥¢ÁµêÊûúÁµ±Âêà
      # ============================================================
      - data:
          type: code
          title: Ê§úÁ¥¢ÁµêÊûúÁµ±Âêà
          desc: „Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢„ÅÆÁµêÊûú„ÇíÁµ±Âêà
          code_language: python3
          code: |
            def main(search_results: list) -> dict:
                if not search_results:
                    return {"integrated_results": "Ê§úÁ¥¢ÁµêÊûú„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"}
                lines = []
                for i, r in enumerate(search_results, 1):
                    if r:
                        lines.append(f"[{i}] {r}")
                return {"integrated_results": "\n\n".join(lines) if lines else "Ê§úÁ¥¢ÁµêÊûú„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"}
          outputs:
            integrated_results:
              children: null
              type: string
          variables:
            - value_selector:
                - iter_keyword_search
                - output
              variable: search_results
          selected: false
        height: 200
        id: code_integrate_search
        position:
          x: 1820
          y: 250
        positionAbsolute:
          x: 1820
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      # ============================================================
      # LLM: „Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêÔºà„Ç´„ÉÜ„Ç¥„É™Âà•Ôºâ
      # ============================================================
      - data:
          type: llm
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêÔºàÊäÄË°ìÁ†îÁ©∂Ôºâ
          desc: ÊäÄË°ìÁ†îÁ©∂„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„ÇíÁîüÊàê
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.4
              max_tokens: 900
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÊäÄË°ì„É™„Çµ„Éº„ÉÅ„ÅÆ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ
                Á†îÁ©∂„ÉÜ„Éº„Éû„Å®Ê§úÁ¥¢ÁµêÊûú„ÇíË∏è„Åæ„Åà„ÄÅÊ∑±Êéò„Çä„Å´ÊúâÁî®„Å™„Çµ„Éñ„ÉÜ„Éº„Éû„Çí3„Äú5ÂÄã„ÄÅÈáçË§á„Å™„ÅèÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                ÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Ê§úÁ¥¢ÁµêÊûúÔºàË¶ÅÁ¥ÑÔºâ:
                {{#code_integrate_search.integrated_results#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"subtopics":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 240
        id: llm_subtopic_tech
        position:
          x: 2180
          y: 90
        positionAbsolute:
          x: 2180
          y: 90
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      - data:
          type: llm
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêÔºàÂ∏ÇÂ†¥ÂàÜÊûêÔºâ
          desc: Â∏ÇÂ†¥ÂàÜÊûê„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„ÇíÁîüÊàê
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.4
              max_tokens: 900
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÂ∏ÇÂ†¥ÂàÜÊûê„ÅÆ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ
                Á†îÁ©∂„ÉÜ„Éº„Éû„Å®Ê§úÁ¥¢ÁµêÊûú„ÇíË∏è„Åæ„Åà„ÄÅÂ∏ÇÂ†¥Ë¶èÊ®°„ÉªÁ´∂Âêà„ÉªÈ°ßÂÆ¢„Éª‰æ°Ê†º„ÉªË¶èÂà∂„Éª„Éà„É¨„É≥„Éâ„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„Çí3„Äú5ÂÄãÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                ÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Ê§úÁ¥¢ÁµêÊûúÔºàË¶ÅÁ¥ÑÔºâ:
                {{#code_integrate_search.integrated_results#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"subtopics":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 240
        id: llm_subtopic_market
        position:
          x: 2180
          y: 220
        positionAbsolute:
          x: 2180
          y: 220
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      - data:
          type: llm
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêÔºàÂ≠¶Ë°ìÁ†îÁ©∂Ôºâ
          desc: Â≠¶Ë°ìÁ†îÁ©∂„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„ÇíÁîüÊàê
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.4
              max_tokens: 900
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÂ≠¶Ë°ìÁ†îÁ©∂„ÅÆ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ
                Á†îÁ©∂„ÉÜ„Éº„Éû„Å®Ê§úÁ¥¢ÁµêÊûú„ÇíË∏è„Åæ„Åà„ÄÅÂÖàË°åÁ†îÁ©∂Ë™øÊüª„Éª‰ªÆË™¨„ÉªÊñπÊ≥ïË´ñ„ÉªË©ï‰æ°ÊåáÊ®ô„ÉªÈôêÁïå/Ë™≤È°å„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„Çí3„Äú5ÂÄãÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                ÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Ê§úÁ¥¢ÁµêÊûúÔºàË¶ÅÁ¥ÑÔºâ:
                {{#code_integrate_search.integrated_results#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"subtopics":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 240
        id: llm_subtopic_academic
        position:
          x: 2180
          y: 350
        positionAbsolute:
          x: 2180
          y: 350
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      - data:
          type: llm
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêÔºà„Éì„Ç∏„Éç„ÇπÊà¶Áï•Ôºâ
          desc: „Éì„Ç∏„Éç„ÇπÊà¶Áï•„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„ÇíÁîüÊàê
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.4
              max_tokens: 900
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØ„Éì„Ç∏„Éç„ÇπÊà¶Áï•„ÅÆ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ
                Á†îÁ©∂„ÉÜ„Éº„Éû„Å®Ê§úÁ¥¢ÁµêÊûú„ÇíË∏è„Åæ„Åà„ÄÅÂèéÁõä„É¢„Éá„É´„ÉªÊñΩÁ≠ñÊ°à„ÉªÂÆüË°åË®àÁîª„Éª„É™„Çπ„ÇØ„ÉªKPI/Ë©ï‰æ°„ÅÆË¶≥ÁÇπ„Åß„Çµ„Éñ„ÉÜ„Éº„Éû„Çí3„Äú5ÂÄãÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                ÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Ê§úÁ¥¢ÁµêÊûúÔºàË¶ÅÁ¥ÑÔºâ:
                {{#code_integrate_search.integrated_results#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"subtopics":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 240
        id: llm_subtopic_business
        position:
          x: 2180
          y: 480
        positionAbsolute:
          x: 2180
          y: 480
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      - data:
          type: llm
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêÔºà„Åù„ÅÆ‰ªñÔºâ
          desc: Ê±éÁî®„ÅÆ„Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàê
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.4
              max_tokens: 900
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØ„É™„Çµ„Éº„ÉÅ„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ
                Á†îÁ©∂„ÉÜ„Éº„Éû„Å®Ê§úÁ¥¢ÁµêÊûú„ÇíË∏è„Åæ„Åà„ÄÅÊ∑±Êéò„Çä„Å´ÊúâÁî®„Å™„Çµ„Éñ„ÉÜ„Éº„Éû„Çí3„Äú5ÂÄãÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
                ÂøÖ„ÅöJSON„ÅßËøî„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                Ê§úÁ¥¢ÁµêÊûúÔºàË¶ÅÁ¥ÑÔºâ:
                {{#code_integrate_search.integrated_results#}}

                Âá∫ÂäõÂΩ¢Âºè:
                {"subtopics":["..."]}
          selected: false
          variables: []
          vision:
            enabled: false
        height: 240
        id: llm_subtopic_other
        position:
          x: 2180
          y: 610
        positionAbsolute:
          x: 2180
          y: 610
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      # ============================================================
      # Code: „Çµ„Éñ„ÉÜ„Éº„ÉûÈÖçÂàóÊï¥ÂΩ¢ÔºàÂêàÊµÅÔºâ
      # ============================================================
      - data:
          type: code
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûÈÖçÂàóÊï¥ÂΩ¢
          desc: ÂàÜÂ≤êLLM„ÅÆÂá∫Âäõ„Åã„ÇâsubtopicsÈÖçÂàó„ÇíÊäΩÂá∫„ÉªÊ≠£Ë¶èÂåñ„Åó„Åæ„Åô
          code_language: python3
          code: |
            import json
            import re

            def _extract_subtopics(text: str) -> list:
                if not text:
                    return []
                m = re.search(r'\{.*"subtopics"\s*:\s*\[.*?\].*\}', text, re.DOTALL)
                if m:
                    try:
                        obj = json.loads(m.group())
                        sts = obj.get("subtopics", [])
                        if isinstance(sts, list):
                            return [str(s).strip() for s in sts if str(s).strip()]
                    except Exception:
                        pass
                m2 = re.search(r'\[.*?\]', text, re.DOTALL)
                if m2:
                    try:
                        arr = json.loads(m2.group())
                        if isinstance(arr, list):
                            return [str(s).strip() for s in arr if str(s).strip()]
                    except Exception:
                        pass
                return [s.strip() for s in text.split(",") if s.strip()]

            def main(llm_text: str) -> dict:
                subtopics = _extract_subtopics(llm_text)
                subtopics = subtopics[:5]
                if not subtopics:
                    subtopics = ["Ê¶ÇË¶Å", "Ë©≥Á¥∞ÂàÜÊûê"]
                return {"subtopics": subtopics}
          outputs:
            subtopics:
              children: null
              type: array[string]
          variables:
            - value_selector:
                - llm_subtopic_other
                - text
              variable: llm_text
          selected: false
        height: 280
        id: code_subtopic_format
        position:
          x: 2560
          y: 250
        positionAbsolute:
          x: 2560
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 360

      # ============================================================
      # Iteration: „Çµ„Éñ„ÉÜ„Éº„ÉûË©≥Á¥∞ÂàÜÊûêÔºàÂÜÖÈÉ®„ÅßÂìÅË≥™ÂÜçÁîüÊàê„É´„Éº„Éó„ÇíÊ®°Êì¨Ôºâ
      # NOTE: Dify DSL„ÅÆLoop„Éé„Éº„Éâ‰ªïÊßòÂ∑ÆÁï∞„ÇíÈÅø„Åë„Çã„Åü„ÇÅ„ÄÅ
      #       „ÄåÊúÄÂ§ß3Âõû„ÅÆÂÜçÁîüÊàê„Äç„ÇíÂçò‰∏ÄLLMÊåáÁ§∫ÔºãÂìÅË≥™„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞„ÅßÊì¨‰ººÂÆüË£ÖÔºàÊé®Â•®„ÅÆÂÆâÂÆöÊßãÊàêÔºâ„ÄÇ
      #       ÂÖ∑‰ΩìÁöÑ„Å´„ÅØ„ÄÅLLM„Å´„ÄåÊúÄÂ§ß3ÂõûËá™Â∑±ÊîπÂñÑ„Åó„Å¶ÊúÄÁµÇÂõûÁ≠î„ÅÆ„ÅøÂá∫„Åô„ÄçÊåáÁ§∫„Çí‰∏é„Åà„ÄÅ
      #       Code„ÅßÂìÅË≥™„Çπ„Ç≥„Ç¢„ÇíË®àÁÆó„Åó„Å¶„É¨„Éù„Éº„Éà„Å∏Ê†ºÁ¥ç„Åó„Åæ„Åô„ÄÇ
      # ============================================================
      - data:
          type: iteration
          title: „Çµ„Éñ„ÉÜ„Éº„ÉûË©≥Á¥∞ÂàÜÊûêÔºàÂèçÂæ©Ôºâ
          desc: ÂêÑ„Çµ„Éñ„ÉÜ„Éº„Éû„Åî„Å®„Å´Ê§úÁ¥¢‚ÜíÂàÜÊûê‚ÜíÂìÅË≥™Ê§úË®º‚ÜíÊï¥ÂΩ¢„ÇíÂÆüË°å
          iterator_selector:
            - code_subtopic_format
            - subtopics
          start_node_id: iter_subtopic_analysisstart
          output_selector:
            - code_analysis_result_format
            - analysis_result
          output_type: array[string]
          is_parallel: false
          parallel_nums: 3
          error_handle_mode: remove-abnormal-output
          selected: false
        height: 520
        id: iter_subtopic_analysis
        position:
          x: 2960
          y: 120
        positionAbsolute:
          x: 2960
          y: 120
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 920
        zIndex: 1

      - data:
          type: iteration-start
          title: ''
          desc: ''
          isInIteration: true
          selected: false
        draggable: false
        height: 48
        id: iter_subtopic_analysisstart
        parentId: iter_subtopic_analysis
        position:
          x: 24
          y: 68
        positionAbsolute:
          x: 2984
          y: 188
        selectable: false
        sourcePosition: right
        targetPosition: left
        type: custom-iteration-start
        width: 44
        zIndex: 1002

      - data:
          type: tool
          title: TavilyÊ§úÁ¥¢Ôºà„Çµ„Éñ„ÉÜ„Éº„ÉûÔºâ
          desc: „Çµ„Éñ„ÉÜ„Éº„Éû„ÅßWebÊ§úÁ¥¢
          provider_type: builtin
          provider_id: tavily
          provider_name: tavily
          tool_name: tavily_search
          tool_label: TavilySearch
          tool_configurations:
            exclude_domains: null
            include_answer: 0
            include_domains: null
            include_images: 0
            include_raw_content: 0
            max_results: 5
            search_depth: basic
          tool_parameters:
            query:
              type: mixed
              value: '{{#iter_subtopic_analysis.item#}}'
          isInIteration: true
          iteration_id: iter_subtopic_analysis
          selected: false
        height: 246
        id: tool_tavily_subtopic
        parentId: iter_subtopic_analysis
        position:
          x: 128
          y: 68
        positionAbsolute:
          x: 3088
          y: 188
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 300
        zIndex: 1002

      - data:
          type: code
          title: Ê§úÁ¥¢ÁµêÊûúÊï¥ÂΩ¢Ôºà„Çµ„Éñ„ÉÜ„Éº„ÉûÔºâ
          desc: „Çµ„Éñ„ÉÜ„Éº„ÉûÊ§úÁ¥¢ÁµêÊûú„ÇíÊï¥ÂΩ¢
          code_language: python3
          code: |
            def main(result_text) -> dict:
                text = ""
                if isinstance(result_text, str):
                    text = result_text
                elif result_text is None:
                    text = ""
                else:
                    text = str(result_text)
                text = text.strip()
                if not text:
                    text = "Ê§úÁ¥¢ÁµêÊûú„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"
                return {"formatted_search_result": text[:1200]}
          outputs:
            formatted_search_result:
              children: null
              type: string
          variables:
            - value_selector:
                - tool_tavily_subtopic
                - text
              variable: result_text
          isInIteration: true
          iteration_id: iter_subtopic_analysis
          selected: false
        height: 210
        id: code_subtopic_search_format
        parentId: iter_subtopic_analysis
        position:
          x: 468
          y: 68
        positionAbsolute:
          x: 3428
          y: 188
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 300
        zIndex: 1002

      - data:
          type: llm
          title: Ë©≥Á¥∞ÂàÜÊûêÔºàËá™Â∑±ÊîπÂñÑÊúÄÂ§ß3ÂõûÔºâ
          desc: „Çµ„Éñ„ÉÜ„Éº„Éû„ÅÆË©≥Á¥∞ÂàÜÊûêÔºàÂìÅË≥™„Åå‰Ωé„ÅÑÂ†¥Âêà„Å´Ëá™Â∑±ÊîπÂñÑ„ÇíÊúÄÂ§ß3ÂõûË°å„ÅÜÔºâ
          context:
            enabled: false
            variable_selector: []
          model:
            mode: chat
            name: gpt-4o
            provider: openai
            completion_params:
              temperature: 0.3
              max_tokens: 1400
              top_p: 1
              presence_penalty: 0
              frequency_penalty: 0
          prompt_template:
            - id: system
              role: system
              text: |
                „ÅÇ„Å™„Åü„ÅØÁ†îÁ©∂„Ç¢„Ç∑„Çπ„Çø„É≥„Éà„Åß„Åô„ÄÇ
                Ê¨°„ÅÆÊâãÈ†Ü„ÇíÂÜÖÈÉ®„ÅßÊúÄÂ§ß3Âõû„Åæ„ÅßÁπ∞„ÇäËøî„Åó„ÄÅÊúÄÁµÇÁöÑ„Å´„ÄåÊîπÂñÑÂæå„ÅÆÊúÄÁµÇÂõûÁ≠î„ÅÆ„Åø„Äç„ÇíÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰∏≠Èñì„ÅÆÊÄùËÄÉ„ÇÑËçâÁ®ø„ÅØÂá∫Âäõ„Åó„Å™„ÅÑÔºâ„ÄÇ
                1) Ë¶ÅÊ±Ç„ÇíÊ∫Ä„Åü„Åó„Å¶„ÅÑ„Çã„ÅãËá™Â∑±Ë©ï‰æ°
                2) ‰∏çË∂≥„Åå„ÅÇ„Çå„Å∞ÊîπÂñÑ
                3) ÊúÄÁµÇÂõûÁ≠î„ÇíÁ¢∫ÂÆö

                Âá∫Âäõ„ÅØÊó•Êú¨Ë™û„Åß„ÄÅË¶ãÂá∫„Åó„Å®ÁÆáÊù°Êõ∏„Åç„ÇíÂê´„ÇÅ„ÄÅÂÖ∑‰ΩìÁöÑ„Å´„ÄÇÊ†πÊã†„Åå‰∏çÊòé„Å™Êñ≠ÂÆö„ÅØÈÅø„Åë„Çã„ÄÇ
            - id: user
              role: user
              text: |
                Á†îÁ©∂„ÉÜ„Éº„Éû:
                {{#code_param_extract.formatted_topic#}}

                „Çµ„Éñ„ÉÜ„Éº„Éû:
                {{#iter_subtopic_analysis.item#}}

                Ê§úÁ¥¢ÁµêÊûúÔºàË¶ÅÁ¥ÑÔºâ:
                {{#code_subtopic_search_format.formatted_search_result#}}

                ‰∏äË®ò„ÇíË∏è„Åæ„Åà„Å¶Ë©≥Á¥∞ÂàÜÊûê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
          isInIteration: true
          iteration_id: iter_subtopic_analysis
          selected: false
          variables: []
          vision:
            enabled: false
        height: 260
        id: llm_detailed_analysis
        parentId: iter_subtopic_analysis
        position:
          x: 808
          y: 68
        positionAbsolute:
          x: 3768
          y: 188
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340
        zIndex: 1002

      - data:
          type: code
          title: ÂìÅË≥™Ê§úË®º
          desc: ÂàÜÊûêÁµêÊûú„ÅÆÂìÅË≥™„Çπ„Ç≥„Ç¢Ôºà0-100Ôºâ„ÇíÁÆóÂá∫
          code_language: python3
          code: |
            def main(analysis_result: str) -> dict:
                text = (analysis_result or "").strip()
                if not text:
                    return {"quality_score": 0, "quality_passed": False}

                score = 0

                # ÊñáÂ≠óÊï∞ÔºàÊúÄÂ§ß50Ôºâ
                length = len(text)
                if length >= 900:
                    score += 50
                elif length >= 700:
                    score += 45
                elif length >= 500:
                    score += 40
                elif length >= 300:
                    score += 30
                elif length >= 150:
                    score += 20
                else:
                    score += 10

                # ÊßãÈÄ†ÔºàÊúÄÂ§ß30Ôºâ
                if "\n" in text:
                    score += 10
                if "##" in text or "###" in text or "„Äê" in text:
                    score += 10
                if "„Éª" in text or "-" in text:
                    score += 10

                # „Ç≠„Éº„ÉØ„Éº„ÉâÔºàÊúÄÂ§ß20Ôºâ
                kws = ["ÂàÜÊûê", "Ë™≤È°å", "ÁµêË´ñ", "Á§∫ÂîÜ", "„É™„Çπ„ÇØ", "ÊñΩÁ≠ñ", "ÊñπÊ≥ï", "Ë©ï‰æ°", "„Éá„Éº„Çø", "Â∏ÇÂ†¥", "ÊäÄË°ì"]
                hit = sum(1 for k in kws if k in text)
                score += min(hit * 2, 20)

                passed = score >= 70
                return {"quality_score": score, "quality_passed": passed}
          outputs:
            quality_score:
              children: null
              type: number
            quality_passed:
              children: null
              type: boolean
          variables:
            - value_selector:
                - llm_detailed_analysis
                - text
              variable: analysis_result
          isInIteration: true
          iteration_id: iter_subtopic_analysis
          selected: false
        height: 280
        id: code_quality_check
        parentId: iter_subtopic_analysis
        position:
          x: 1188
          y: 68
        positionAbsolute:
          x: 4148
          y: 188
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320
        zIndex: 1002

      - data:
          type: code
          title: ÂàÜÊûêÁµêÊûúÊï¥ÂΩ¢
          desc: „Çµ„Éñ„ÉÜ„Éº„ÉûÂàÜÊûêÁµêÊûú„ÇíÊï¥ÂΩ¢Ôºà„Çπ„Ç≥„Ç¢‰ªò‰∏éÔºâ
          code_language: python3
          code: |
            def main(subtopic: str, analysis_result: str, quality_score: float, quality_passed: bool) -> dict:
                st = (subtopic or "").strip() or "„Çµ„Éñ„ÉÜ„Éº„Éû"
                ar = (analysis_result or "").strip() or "ÂàÜÊûêÁµêÊûú„ÅåÁîüÊàê„Åï„Çå„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"
                status = "PASS" if quality_passed else "WARN"
                formatted = f"„Äê{st}„Äë({status}, score={quality_score}/100)\n\n{ar}"
                return {"analysis_result": formatted}
          outputs:
            analysis_result:
              children: null
              type: string
          variables:
            - value_selector:
                - iter_subtopic_analysis
                - item
              variable: subtopic
            - value_selector:
                - llm_detailed_analysis
                - text
              variable: analysis_result
            - value_selector:
                - code_quality_check
                - quality_score
              variable: quality_score
            - value_selector:
                - code_quality_check
                - quality_passed
              variable: quality_passed
          isInIteration: true
          iteration_id: iter_subtopic_analysis
          selected: false
        height: 240
        id: code_analysis_result_format
        parentId: iter_subtopic_analysis
        position:
          x: 1548
          y: 68
        positionAbsolute:
          x: 4508
          y: 188
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320
        zIndex: 1002

      # ============================================================
      # Code: „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞
      # ============================================================
      - data:
          type: code
          title: „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞
          desc: ÂàÜÊûêÁµêÊûú„ÅåÁ©∫„ÅÆÂ†¥Âêà„ÅÆ‰ª£ÊõøÂá¶ÁêÜ
          code_language: python3
          code: |
            def main(analysis_results: list) -> dict:
                if not analysis_results:
                    return {"final_analysis_results": ["ÂàÜÊûêÁµêÊûú„ÅåÁîüÊàê„Åï„Çå„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"]}
                cleaned = []
                for r in analysis_results:
                    if r is None:
                        continue
                    s = str(r).strip()
                    if s:
                        cleaned.append(s)
                if not cleaned:
                    cleaned = ["ÂàÜÊûêÁµêÊûú„ÅåÁîüÊàê„Åï„Çå„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ"]
                return {"final_analysis_results": cleaned}
          outputs:
            final_analysis_results:
              children: null
              type: array[string]
          variables:
            - value_selector:
                - iter_subtopic_analysis
                - output
              variable: analysis_results
          selected: false
        height: 220
        id: code_error_handle
        position:
          x: 3920
          y: 250
        positionAbsolute:
          x: 3920
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 320

      # ============================================================
      # Code: „É¨„Éù„Éº„ÉàÊï¥ÂΩ¢
      # ============================================================
      - data:
          type: code
          title: „É¨„Éù„Éº„ÉàÊï¥ÂΩ¢
          desc: ÊúÄÁµÇ„É¨„Éù„Éº„Éà„ÇíJSONÊñáÂ≠óÂàó„Å®„Åó„Å¶ÁîüÊàê
          code_language: python3
          code: |
            import json
            from datetime import datetime, timezone

            def main(research_topic: str, keywords: list, subtopics: list, analysis_results: list) -> dict:
                report = {
                    "research_topic": (research_topic or "").strip(),
                    "keywords": keywords or [],
                    "subtopics": subtopics or [],
                    "analysis_results": analysis_results or [],
                    "generated_at": datetime.now(timezone.utc).isoformat()
                }
                return {"report": json.dumps(report, ensure_ascii=False, indent=2)}
          outputs:
            report:
              children: null
              type: string
          variables:
            - value_selector:
                - code_param_extract
                - formatted_topic
              variable: research_topic
            - value_selector:
                - code_keyword_format
                - keywords
              variable: keywords
            - value_selector:
                - code_subtopic_format
                - subtopics
              variable: subtopics
            - value_selector:
                - code_error_handle
                - final_analysis_results
              variable: analysis_results
          selected: false
        height: 260
        id: code_report_format
        position:
          x: 4280
          y: 250
        positionAbsolute:
          x: 4280
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 340

      # ============================================================
      # End
      # ============================================================
      - data:
          type: end
          title: ÁµÇ‰∫Ü
          desc: „ÉØ„Éº„ÇØ„Éï„É≠„ÉºÁµÇ‰∫Ü
          outputs:
            - value_selector:
                - code_report_format
                - report
              variable: report
          selected: false
        height: 120
        id: end_research
        position:
          x: 4660
          y: 250
        positionAbsolute:
          x: 4660
          y: 250
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 242

    edges:
      # Start ‚Üí Question Classifier
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: start
          targetType: question-classifier
        id: edge-start-qc
        source: start_research
        sourceHandle: source
        target: qc_research
        targetHandle: target
        type: custom
        zIndex: 0

      # Question Classifier ‚Üí CodeÔºàÂâçÂá¶ÁêÜÔºâ‚ÄªÂÖ®„ÇØ„É©„ÇπÂêàÊµÅ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: question-classifier
          targetType: code
        id: edge-qc-to-code-tech
        source: qc_research
        sourceHandle: tech_research
        target: code_param_extract
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: question-classifier
          targetType: code
        id: edge-qc-to-code-market
        source: qc_research
        sourceHandle: market_analysis
        target: code_param_extract
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: question-classifier
          targetType: code
        id: edge-qc-to-code-academic
        source: qc_research
        sourceHandle: academic_research
        target: code_param_extract
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: question-classifier
          targetType: code
        id: edge-qc-to-code-business
        source: qc_research
        sourceHandle: business_strategy
        target: code_param_extract
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: question-classifier
          targetType: code
        id: edge-qc-to-code-other
        source: qc_research
        sourceHandle: other
        target: code_param_extract
        targetHandle: target
        type: custom
        zIndex: 0

      # CodeÔºàÂâçÂá¶ÁêÜÔºâ‚Üí ÂêÑ„Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫LLMÔºàÂàÜÂ≤êÔºâ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-code-to-llm-keyword-tech
        source: code_param_extract
        sourceHandle: source
        target: llm_keyword_tech
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-code-to-llm-keyword-market
        source: code_param_extract
        sourceHandle: source
        target: llm_keyword_market
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-code-to-llm-keyword-academic
        source: code_param_extract
        sourceHandle: source
        target: llm_keyword_academic
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-code-to-llm-keyword-business
        source: code_param_extract
        sourceHandle: source
        target: llm_keyword_business
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-code-to-llm-keyword-other
        source: code_param_extract
        sourceHandle: source
        target: llm_keyword_other
        targetHandle: target
        type: custom
        zIndex: 0

      # ÂêÑ„Ç≠„Éº„ÉØ„Éº„ÉâÊäΩÂá∫LLM ‚Üí „Ç≠„Éº„ÉØ„Éº„ÉâÊï¥ÂΩ¢ÔºàÂêàÊµÅÔºâ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-llm-keyword-tech-to-code-format
        source: llm_keyword_tech
        sourceHandle: source
        target: code_keyword_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-llm-keyword-market-to-code-format
        source: llm_keyword_market
        sourceHandle: source
        target: code_keyword_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-llm-keyword-academic-to-code-format
        source: llm_keyword_academic
        sourceHandle: source
        target: code_keyword_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-llm-keyword-business-to-code-format
        source: llm_keyword_business
        sourceHandle: source
        target: code_keyword_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-llm-keyword-other-to-code-format
        source: llm_keyword_other
        sourceHandle: source
        target: code_keyword_format
        targetHandle: target
        type: custom
        zIndex: 0

      # „Ç≠„Éº„ÉØ„Éº„ÉâÊï¥ÂΩ¢ ‚Üí IterationÔºà„Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢Ôºâ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: iteration
        id: edge-code-keyword-to-iter
        source: code_keyword_format
        sourceHandle: source
        target: iter_keyword_search
        targetHandle: target
        type: custom
        zIndex: 0

      # IterationÂÜÖ: start ‚Üí tool ‚Üí code
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_keyword_search
          sourceType: iteration-start
          targetType: tool
        id: edge-iter-keyword-start-tool
        source: iter_keyword_searchstart
        sourceHandle: source
        target: tool_tavily_keyword
        targetHandle: target
        type: custom
        zIndex: 1002
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_keyword_search
          sourceType: tool
          targetType: code
        id: edge-tool-keyword-to-code-format
        source: tool_tavily_keyword
        sourceHandle: source
        target: code_keyword_search_format
        targetHandle: target
        type: custom
        zIndex: 1002

      # IterationÔºà„Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢Ôºâ‚Üí Ê§úÁ¥¢ÁµêÊûúÁµ±Âêà
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: iteration
          targetType: code
        id: edge-iter-keyword-to-code-integrate
        source: iter_keyword_search
        sourceHandle: source
        target: code_integrate_search
        targetHandle: target
        type: custom
        zIndex: 0

      # Ê§úÁ¥¢ÁµêÊûúÁµ±Âêà ‚Üí ÂêÑ„Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêLLMÔºàÂàÜÂ≤êÔºâ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-integrate-to-subtopic-tech
        source: code_integrate_search
        sourceHandle: source
        target: llm_subtopic_tech
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-integrate-to-subtopic-market
        source: code_integrate_search
        sourceHandle: source
        target: llm_subtopic_market
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-integrate-to-subtopic-academic
        source: code_integrate_search
        sourceHandle: source
        target: llm_subtopic_academic
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-integrate-to-subtopic-business
        source: code_integrate_search
        sourceHandle: source
        target: llm_subtopic_business
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: llm
        id: edge-integrate-to-subtopic-other
        source: code_integrate_search
        sourceHandle: source
        target: llm_subtopic_other
        targetHandle: target
        type: custom
        zIndex: 0

      # ÂêÑ„Çµ„Éñ„ÉÜ„Éº„ÉûÁîüÊàêLLM ‚Üí „Çµ„Éñ„ÉÜ„Éº„ÉûÊï¥ÂΩ¢ÔºàÂêàÊµÅÔºâ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-subtopic-tech-to-format
        source: llm_subtopic_tech
        sourceHandle: source
        target: code_subtopic_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-subtopic-market-to-format
        source: llm_subtopic_market
        sourceHandle: source
        target: code_subtopic_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-subtopic-academic-to-format
        source: llm_subtopic_academic
        sourceHandle: source
        target: code_subtopic_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-subtopic-business-to-format
        source: llm_subtopic_business
        sourceHandle: source
        target: code_subtopic_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: llm
          targetType: code
        id: edge-subtopic-other-to-format
        source: llm_subtopic_other
        sourceHandle: source
        target: code_subtopic_format
        targetHandle: target
        type: custom
        zIndex: 0

      # „Çµ„Éñ„ÉÜ„Éº„ÉûÊï¥ÂΩ¢ ‚Üí IterationÔºà„Çµ„Éñ„ÉÜ„Éº„ÉûË©≥Á¥∞ÂàÜÊûêÔºâ
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: iteration
        id: edge-subtopic-format-to-iter-analysis
        source: code_subtopic_format
        sourceHandle: source
        target: iter_subtopic_analysis
        targetHandle: target
        type: custom
        zIndex: 0

      # IterationÂÜÖÔºà„Çµ„Éñ„ÉÜ„Éº„ÉûÔºâ: start ‚Üí tool ‚Üí code ‚Üí llm ‚Üí code ‚Üí code
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_subtopic_analysis
          sourceType: iteration-start
          targetType: tool
        id: edge-iter-subtopic-start-tool
        source: iter_subtopic_analysisstart
        sourceHandle: source
        target: tool_tavily_subtopic
        targetHandle: target
        type: custom
        zIndex: 1002
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_subtopic_analysis
          sourceType: tool
          targetType: code
        id: edge-tool-subtopic-to-code-format
        source: tool_tavily_subtopic
        sourceHandle: source
        target: code_subtopic_search_format
        targetHandle: target
        type: custom
        zIndex: 1002
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_subtopic_analysis
          sourceType: code
          targetType: llm
        id: edge-code-subtopic-to-llm-analysis
        source: code_subtopic_search_format
        sourceHandle: source
        target: llm_detailed_analysis
        targetHandle: target
        type: custom
        zIndex: 1002
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_subtopic_analysis
          sourceType: llm
          targetType: code
        id: edge-llm-analysis-to-quality
        source: llm_detailed_analysis
        sourceHandle: source
        target: code_quality_check
        targetHandle: target
        type: custom
        zIndex: 1002
      - data:
          isInIteration: true
          isInLoop: false
          iteration_id: iter_subtopic_analysis
          sourceType: code
          targetType: code
        id: edge-quality-to-format
        source: code_quality_check
        sourceHandle: source
        target: code_analysis_result_format
        targetHandle: target
        type: custom
        zIndex: 1002

      # IterationÔºà„Çµ„Éñ„ÉÜ„Éº„ÉûÔºâ‚Üí „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞ ‚Üí „É¨„Éù„Éº„ÉàÊï¥ÂΩ¢ ‚Üí End
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: iteration
          targetType: code
        id: edge-iter-analysis-to-error
        source: iter_subtopic_analysis
        sourceHandle: source
        target: code_error_handle
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: code
        id: edge-error-to-report
        source: code_error_handle
        sourceHandle: source
        target: code_report_format
        targetHandle: target
        type: custom
        zIndex: 0
      - data:
          isInIteration: false
          isInLoop: false
          sourceType: code
          targetType: end
        id: edge-report-to-end
        source: code_report_format
        sourceHandle: source
        target: end_research
        targetHandle: target
        type: custom
        zIndex: 0

    viewport:
      x: 0
      y: 0
      zoom: 0.7

  rag_pipeline_variables: []